{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/ipad-classroom-scheduler/src/app/admin/users/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport useSWR from 'swr';\r\nimport { useSession } from 'next-auth/react';\r\nimport { format } from 'date-fns';\r\nimport Link from 'next/link';\r\n\r\ninterface User {\r\n    id: number;\r\n    tenant_id: number;\r\n    email: string;\r\n    role: 'SYSTEM_ADMIN' | 'ORG_ADMIN' | 'SCHEDULER' | 'VIEWER';\r\n    created_at: string;\r\n}\r\n\r\ninterface Tenant {\r\n    id: number;\r\n    name: string;\r\n}\r\n\r\nconst fetcher = (url: string) => fetch(url).then((res) => res.json());\r\n\r\nconst ROLE_OPTIONS = [\r\n    { value: 'SYSTEM_ADMIN', label: 'System Admin', description: 'Full access to all tenants' },\r\n    { value: 'ORG_ADMIN', label: 'Organization Admin', description: 'Manage their organization' },\r\n    { value: 'SCHEDULER', label: 'Scheduler', description: 'Create and manage events' },\r\n    { value: 'VIEWER', label: 'Viewer', description: 'Read-only access' },\r\n];\r\n\r\nexport default function UsersPage() {\r\n    const { data: session } = useSession();\r\n    const [selectedTenant, setSelectedTenant] = useState<number>(1);\r\n    const [successMessage, setSuccessMessage] = useState<string | null>(null);\r\n\r\n    const isSuperAdmin = session?.user?.role === 'SYSTEM_ADMIN';\r\n\r\n    const { data: tenants } = useSWR<Tenant[]>('/api/tenants', fetcher);\r\n    const { data: users, mutate: mutateUsers } = useSWR<User[]>(\r\n        `/api/users?tenant_id=${selectedTenant}`,\r\n        fetcher\r\n    );\r\n\r\n    const handleCreateUser = async (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        const formData = new FormData(e.currentTarget);\r\n\r\n        try {\r\n            const response = await fetch('/api/users', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    tenant_id: isSuperAdmin ? formData.get('tenant_id') : selectedTenant,\r\n                    email: formData.get('email'),\r\n                    password: formData.get('password'),\r\n                    role: formData.get('role'),\r\n                }),\r\n            });\r\n\r\n            if (response.ok) {\r\n                mutateUsers();\r\n                e.currentTarget.reset();\r\n                setSuccessMessage('User created successfully!');\r\n                setTimeout(() => setSuccessMessage(null), 3000);\r\n            } else {\r\n                const data = await response.json();\r\n                alert(data.error || 'Failed to create user');\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to create user:', error);\r\n            alert('Failed to create user');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50 p-8\">\r\n            <div className=\"max-w-6xl mx-auto\">\r\n                {/* Header */}\r\n                <div className=\"mb-8\">\r\n                    <Link href=\"/admin\" className=\"text-blue-600 hover:text-blue-700 mb-4 inline-block\">\r\n                        ‚Üê Back to Admin Dashboard\r\n                    </Link>\r\n                    <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">User Management</h1>\r\n                    <p className=\"text-slate-600\">Create and manage user accounts</p>\r\n                </div>\r\n\r\n                {/* Tenant Selector (Super Admin only) */}\r\n                {isSuperAdmin && tenants && tenants.length > 0 && (\r\n                    <div className=\"mb-6 bg-white rounded-xl shadow p-6\">\r\n                        <label className=\"block text-sm font-medium text-slate-700 mb-2\">\r\n                            Select Organization\r\n                        </label>\r\n                        <select\r\n                            value={selectedTenant}\r\n                            onChange={(e) => setSelectedTenant(parseInt(e.target.value))}\r\n                            className=\"px-4 py-2 border border-slate-300 rounded-lg bg-white\"\r\n                        >\r\n                            {tenants.map((tenant) => (\r\n                                <option key={tenant.id} value={tenant.id}>\r\n                                    {tenant.name}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Success Message */}\r\n                {successMessage && (\r\n                    <div className=\"mb-6 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg\">\r\n                        {successMessage}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Create User Form */}\r\n                <div className=\"bg-white rounded-xl shadow p-6 mb-8\">\r\n                    <h2 className=\"text-2xl font-bold text-slate-900 mb-4\">Create New User</h2>\r\n                    <form onSubmit={handleCreateUser}>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\r\n                            {/* Tenant Selection (Super Admin only) */}\r\n                            {isSuperAdmin && (\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-slate-700 mb-2\">\r\n                                        Organization <span className=\"text-red-500\">*</span>\r\n                                    </label>\r\n                                    <select\r\n                                        name=\"tenant_id\"\r\n                                        required\r\n                                        defaultValue={selectedTenant}\r\n                                        className=\"w-full px-3 py-2 border border-slate-300 rounded-lg\"\r\n                                    >\r\n                                        {tenants?.map((tenant) => (\r\n                                            <option key={tenant.id} value={tenant.id}>\r\n                                                {tenant.name}\r\n                                            </option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Email */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-slate-700 mb-2\">\r\n                                    Email <span className=\"text-red-500\">*</span>\r\n                                </label>\r\n                                <input\r\n                                    type=\"email\"\r\n                                    name=\"email\"\r\n                                    required\r\n                                    placeholder=\"user@example.com\"\r\n                                    className=\"w-full px-3 py-2 border border-slate-300 rounded-lg\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Password */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-slate-700 mb-2\">\r\n                                    Password <span className=\"text-red-500\">*</span>\r\n                                </label>\r\n                                <input\r\n                                    type=\"password\"\r\n                                    name=\"password\"\r\n                                    required\r\n                                    minLength={8}\r\n                                    placeholder=\"Minimum 8 characters\"\r\n                                    className=\"w-full px-3 py-2 border border-slate-300 rounded-lg\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Role */}\r\n                            <div className=\"md:col-span-2\">\r\n                                <label className=\"block text-sm font-medium text-slate-700 mb-2\">\r\n                                    Role <span className=\"text-red-500\">*</span>\r\n                                </label>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3\">\r\n                                    {ROLE_OPTIONS.map((option) => (\r\n                                        <label\r\n                                            key={option.value}\r\n                                            className=\"relative flex items-start p-3 border border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50\"\r\n                                        >\r\n                                            <input\r\n                                                type=\"radio\"\r\n                                                name=\"role\"\r\n                                                value={option.value}\r\n                                                required\r\n                                                className=\"mt-0.5 mr-3\"\r\n                                            />\r\n                                            <div>\r\n                                                <div className=\"font-medium text-slate-900\">{option.label}</div>\r\n                                                <div className=\"text-xs text-slate-500\">{option.description}</div>\r\n                                            </div>\r\n                                        </label>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <button\r\n                            type=\"submit\"\r\n                            className=\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-semibold\"\r\n                        >\r\n                            Create User\r\n                        </button>\r\n                    </form>\r\n                </div>\r\n\r\n                {/* Users List */}\r\n                <div className=\"bg-white rounded-xl shadow p-6\">\r\n                    <h2 className=\"text-2xl font-bold text-slate-900 mb-4\">Existing Users</h2>\r\n\r\n                    {!users || users.length === 0 ? (\r\n                        <p className=\"text-slate-500 text-center py-8\">No users found for this organization.</p>\r\n                    ) : (\r\n                        <div className=\"overflow-x-auto\">\r\n                            <table className=\"w-full\">\r\n                                <thead className=\"bg-slate-50 border-b border-slate-200\">\r\n                                    <tr>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-semibold text-slate-700\">Email</th>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-semibold text-slate-700\">Role</th>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-semibold text-slate-700\">Created</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody className=\"divide-y divide-slate-200\">\r\n                                    {users.map((user) => (\r\n                                        <tr key={user.id} className=\"hover:bg-slate-50\">\r\n                                            <td className=\"px-4 py-3 text-sm\">{user.email}</td>\r\n                                            <td className=\"px-4 py-3 text-sm\">\r\n                                                <span\r\n                                                    className={`inline-block px-2 py-1 rounded text-xs font-medium ${user.role === 'SYSTEM_ADMIN'\r\n                                                            ? 'bg-purple-100 text-purple-800'\r\n                                                            : user.role === 'ORG_ADMIN'\r\n                                                                ? 'bg-blue-100 text-blue-800'\r\n                                                                : user.role === 'SCHEDULER'\r\n                                                                    ? 'bg-green-100 text-green-800'\r\n                                                                    : 'bg-gray-100 text-gray-800'\r\n                                                        }`}\r\n                                                >\r\n                                                    {user.role.replace('_', ' ')}\r\n                                                </span>\r\n                                            </td>\r\n                                            <td className=\"px-4 py-3 text-sm text-slate-600\">\r\n                                                {format(new Date(user.created_at), 'MMM d, yyyy')}\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}
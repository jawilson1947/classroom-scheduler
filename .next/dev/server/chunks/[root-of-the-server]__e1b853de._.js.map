{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/ipad-classroom-scheduler/src/lib/db.ts"],"sourcesContent":["import mysql from 'mysql2/promise';\r\n\r\nconst pool = mysql.createPool({\r\n    host: process.env.MYSQL_HOST,\r\n    user: process.env.MYSQL_USER,\r\n    password: process.env.MYSQL_PASSWORD,\r\n    database: process.env.MYSQL_DATABASE,\r\n    waitForConnections: true,\r\n    connectionLimit: 10,\r\n    queueLimit: 0,\r\n});\r\n\r\nexport default pool;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,OAAO,8IAAK,CAAC,UAAU,CAAC;IAC1B,MAAM,QAAQ,GAAG,CAAC,UAAU;IAC5B,MAAM,QAAQ,GAAG,CAAC,UAAU;IAC5B,UAAU,QAAQ,GAAG,CAAC,cAAc;IACpC,UAAU,QAAQ,GAAG,CAAC,cAAc;IACpC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;AAChB;uCAEe"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///C:/ipad-classroom-scheduler/src/app/api/events/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport pool from '@/lib/db';\r\nimport { RowDataPacket } from 'mysql2';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const searchParams = request.nextUrl.searchParams;\r\n        const roomId = searchParams.get('room_id');\r\n        const startDate = searchParams.get('start_date');\r\n        const endDate = searchParams.get('end_date');\r\n        const tenantId = searchParams.get('tenant_id') || '1'; // Default to tenant 1 for now\r\n\r\n        let query = 'SELECT * FROM events WHERE tenant_id = ?';\r\n        const params: any[] = [tenantId];\r\n\r\n        if (roomId) {\r\n            query += ' AND room_id = ?';\r\n            params.push(roomId);\r\n        }\r\n\r\n        if (startDate && endDate) {\r\n            query += ' AND start_time >= ? AND end_time <= ?';\r\n            params.push(startDate, endDate);\r\n        }\r\n\r\n        query += ' ORDER BY start_time ASC';\r\n\r\n        const [rows] = await pool.query<RowDataPacket[]>(query, params);\r\n        return NextResponse.json(rows);\r\n    } catch (error) {\r\n        console.error('Error fetching events:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch events' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const body = await request.json();\r\n        const { tenant_id, room_id, title, facilitator_name, start_time, end_time, description, event_type } = body;\r\n\r\n        // Check for conflicts\r\n        const [conflicts] = await pool.query<RowDataPacket[]>(\r\n            `SELECT * FROM events \r\n       WHERE tenant_id = ? AND room_id = ? \r\n       AND ((start_time < ? AND end_time > ?) OR (start_time < ? AND end_time > ?))`,\r\n            [tenant_id, room_id, end_time, start_time, end_time, start_time]\r\n        );\r\n\r\n        if (conflicts.length > 0) {\r\n            return NextResponse.json({ error: 'Time conflict detected' }, { status: 409 });\r\n        }\r\n\r\n        const [result] = await pool.query(\r\n            `INSERT INTO events (tenant_id, room_id, title, facilitator_name, start_time, end_time, description, event_type) \r\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?)`,\r\n            [tenant_id, room_id, title, facilitator_name, start_time, end_time, description, event_type]\r\n        );\r\n\r\n        return NextResponse.json({ success: true, id: (result as any).insertId }, { status: 201 });\r\n    } catch (error) {\r\n        console.error('Error creating event:', error);\r\n        return NextResponse.json({ error: 'Failed to create event' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAGO,eAAe,IAAI,OAAoB;IAC1C,IAAI;QACA,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;QACjD,MAAM,SAAS,aAAa,GAAG,CAAC;QAChC,MAAM,YAAY,aAAa,GAAG,CAAC;QACnC,MAAM,UAAU,aAAa,GAAG,CAAC;QACjC,MAAM,WAAW,aAAa,GAAG,CAAC,gBAAgB,KAAK,8BAA8B;QAErF,IAAI,QAAQ;QACZ,MAAM,SAAgB;YAAC;SAAS;QAEhC,IAAI,QAAQ;YACR,SAAS;YACT,OAAO,IAAI,CAAC;QAChB;QAEA,IAAI,aAAa,SAAS;YACtB,SAAS;YACT,OAAO,IAAI,CAAC,WAAW;QAC3B;QAEA,SAAS;QAET,MAAM,CAAC,KAAK,GAAG,MAAM,6HAAI,CAAC,KAAK,CAAkB,OAAO;QACxD,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAChF;AACJ;AAEO,eAAe,KAAK,OAAoB;IAC3C,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAE,UAAU,EAAE,QAAQ,EAAE,WAAW,EAAE,UAAU,EAAE,GAAG;QAEvG,sBAAsB;QACtB,MAAM,CAAC,UAAU,GAAG,MAAM,6HAAI,CAAC,KAAK,CAChC,CAAC;;mFAEsE,CAAC,EACxE;YAAC;YAAW;YAAS;YAAU;YAAY;YAAU;SAAW;QAGpE,IAAI,UAAU,MAAM,GAAG,GAAG;YACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAChF;QAEA,MAAM,CAAC,OAAO,GAAG,MAAM,6HAAI,CAAC,KAAK,CAC7B,CAAC;sCACyB,CAAC,EAC3B;YAAC;YAAW;YAAS;YAAO;YAAkB;YAAY;YAAU;YAAa;SAAW;QAGhG,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,IAAI,AAAC,OAAe,QAAQ;QAAC,GAAG;YAAE,QAAQ;QAAI;IAC5F,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAChF;AACJ"}}]
}